<nav class="navbar">
  <div class="navbar-container">
    <!-- Logo y Video Container -->
    <div class="navbar-brand">
      <div class="navbar-logo" routerLink="/">
        <img ngSrc="assets/img/Logo_Grivyzom_navbar.png" alt="Logo Grivyzom" class="logo-image" width="180" height="78"
          priority>
      </div>

      <!-- Mini GIF Container -->
      <div class="mini-video-container">
        <img [src]="videoSource" alt="Puente M谩gico" class="mini-video">
      </div>
    </div>

    <!-- Spacer to push actions to the right -->
    <div class="navbar-spacer"></div>

    <!-- Hamburger Menu Button (Mobile) -->
    <button class="hamburger-menu" [class.active]="isMenuOpen()" (click)="toggleMenu()" aria-label="Men煤">
      <span class="hamburger-line"></span>
      <span class="hamburger-line"></span>
      <span class="hamburger-line"></span>
    </button>

    <!-- Action Icons (Desktop) / Mobile Menu -->
    <div class="navbar-actions" [class.mobile-menu-open]="isMenuOpen()">

      <!-- Navegaci贸n Principal -->
      <a class="nav-link" routerLink="/" routerLinkActive="active" [routerLinkActiveOptions]="{exact: true}">
        <lucide-icon [img]="icons.Home" [size]="18" [strokeWidth]="2"></lucide-icon>
        <span>Inicio</span>
      </a>

      <a class="nav-link" routerLink="/foro" routerLinkActive="active">
        <lucide-icon [img]="icons.MessageSquare" [size]="18" [strokeWidth]="2"></lucide-icon>
        <span>Foro</span>
      </a>

      <a class="nav-link" routerLink="/tienda" routerLinkActive="active">
        <lucide-icon [img]="icons.ShoppingBag" [size]="18" [strokeWidth]="2"></lucide-icon>
        <span>Tienda</span>
      </a>

      <a class="nav-link" href="https://vote.grivyzom.com" target="_blank" rel="noopener">
        <lucide-icon [img]="icons.Vote" [size]="18" [strokeWidth]="2"></lucide-icon>
        <span>Votar</span>
      </a>

      <!-- Recursos Dropdown (Docs, Rankings, Herramientas) -->
      <app-nav-dropdown label="Recursos" [icon]="icons.FolderOpen" [items]="resourcesMenuItems" triggerClass="nav-link">
      </app-nav-dropdown>

      <!-- Separador y bot贸n de acceso (no autenticado) -->
      @if (!isAuthenticated()) {
      <div class="nav-separator"></div>
      <button class="access-btn" title="Iniciar sesi贸n o registrarse" (click)="onLogin()">
        <span class="access-btn-glow"></span>
        <span class="access-btn-content">
          <lucide-icon [img]="icons.User" [size]="20" [strokeWidth]="2"></lucide-icon>
          <span class="access-btn-text">Acceder</span>
        </span>
      </button>
      }

      <!-- Bot贸n de perfil y logout (autenticado) -->
      @if (isAuthenticated()) {
      <div class="user-section">
        <!-- Grovs Balance Badge -->
        <div class="grovs-balance-badge" [routerLink]="['/profile']" [queryParams]="{tab: 'grovs'}" title="Mis Grovs">
          <span class="grovs-icon"></span>
          <span class="grovs-amount">{{ grovsBalance() }}</span>
        </div>

        <!-- Profile Dropdown (incluye Admin para staff, Perfil, Settings, Logout) -->
        <app-profile-dropdown [user]="currentUser()" [avatarUrl]="getAvatarUrl()" (logout)="onLogout()">
        </app-profile-dropdown>
      </div>
      }
    </div>
  </div>
</nav>

<!-- Modal de selecci贸n de IPs -->
@if (showIPModal()) {
<app-base-modal title="Direcciones de Servidores" (onClose)="closeIPModal()" maxWidth="420px">
  <app-ip-addresses-dropdown (onServerSelect)="onServerSelect($event)" [showInfoButton]="true"
    (onInfoClick)="openInfoModal()" (onDone)="closeIPModal()">
  </app-ip-addresses-dropdown>
</app-base-modal>
}

<!-- Modal de informaci贸n "驴Por qu茅 hay varias direcciones?" -->
@if (showInfoModal()) {
<app-base-modal title="驴Por qu茅 hay varias direcciones?" (onClose)="closeInfoModal()" maxWidth="550px">
  <app-why-multiple-servers [isStandalone]="true"></app-why-multiple-servers>
</app-base-modal>
}