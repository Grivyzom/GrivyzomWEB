<div class="event-detail-panel" @slideInRight>
    <!-- Overlay backdrop -->
    <div class="panel-backdrop" (click)="close()"></div>

    <!-- Panel content -->
    <div class="panel-content">
        <!-- Close button -->
        <button class="close-button" (click)="close()" type="button" aria-label="Cerrar">
            <lucide-angular [img]="icons.X" [size]="24"></lucide-angular>
        </button>

        <!-- Event Banner -->
        @if (event.bannerUrl || event.imageUrl) {
            <div class="event-banner">
                <img [src]="event.bannerUrl || event.imageUrl" [alt]="event.title" />
                <div class="banner-overlay"></div>
            </div>
        }

        <!-- Event Content -->
        <div class="event-content">
            <!-- Category Badge -->
            <div class="category-badge"
                 [style.background-color]="getCategoryConfig().bgColor"
                 [style.color]="getCategoryConfig().color">
                <span class="badge-icon">{{ getCategoryConfig().icon }}</span>
                <span class="badge-label">{{ getCategoryConfig().name }}</span>
            </div>

            <!-- Event Title -->
            <h2 class="event-title">{{ event.title }}</h2>

            <!-- Status Badge -->
            <div class="status-section">
                <span class="status-badge" [class]="'status-' + event.status">
                    {{ statusLabel }}
                </span>
            </div>

            <!-- Event Meta Info -->
            <div class="meta-section">
                <div class="meta-item">
                    <div class="meta-icon">
                        <lucide-angular [img]="icons.Calendar" [size]="18"></lucide-angular>
                    </div>
                    <div class="meta-content">
                        <span class="meta-label">Fecha</span>
                        <span class="meta-value">{{ formattedDate }}</span>
                    </div>
                </div>

                <div class="meta-item">
                    <div class="meta-icon">
                        <lucide-angular [img]="icons.Clock" [size]="18"></lucide-angular>
                    </div>
                    <div class="meta-content">
                        <span class="meta-label">Hora</span>
                        <span class="meta-value">{{ formattedTime }}</span>
                    </div>
                </div>

                @if (event.location) {
                    <div class="meta-item">
                        <div class="meta-icon">
                            <lucide-angular [img]="icons.MapPin" [size]="18"></lucide-angular>
                        </div>
                        <div class="meta-content">
                            <span class="meta-label">Ubicación</span>
                            <span class="meta-value">{{ event.location }}</span>
                        </div>
                    </div>
                }

                @if (event.maxParticipants) {
                    <div class="meta-item">
                        <div class="meta-icon">
                            <lucide-angular [img]="icons.Users" [size]="18"></lucide-angular>
                        </div>
                        <div class="meta-content">
                            <span class="meta-label">Participantes</span>
                            <span class="meta-value">
                                {{ event.currentParticipants || 0 }} / {{ event.maxParticipants }}
                            </span>
                        </div>
                    </div>
                }
            </div>

            <!-- Event Description -->
            <div class="description-section">
                <h3 class="section-title">Descripción</h3>
                <p class="event-description">{{ event.description }}</p>
            </div>

            <!-- Prizes Section -->
            @if (event.prizes.length > 0) {
                <div class="prizes-section">
                    <h3 class="section-title">
                        <lucide-angular [img]="icons.Trophy" [size]="20"></lucide-angular>
                        Premios
                    </h3>

                    <div class="prizes-grid">
                        @for (prize of event.prizes; track prize.id) {
                            <div class="prize-card"
                                 [style.background-color]="getRarityColors(prize.rarity).bg"
                                 [style.border-color]="getRarityColors(prize.rarity).border">

                                @if (prize.position) {
                                    <div class="prize-position">
                                        {{ getPositionLabel(prize.position) }}
                                    </div>
                                }

                                @if (prize.imageUrl) {
                                    <div class="prize-image">
                                        <img [src]="prize.imageUrl" [alt]="prize.name" />
                                    </div>
                                }

                                <h4 class="prize-name">{{ prize.name }}</h4>

                                @if (prize.description) {
                                    <p class="prize-description">{{ prize.description }}</p>
                                }

                                <div class="prize-rarity"
                                     [style.color]="getRarityColors(prize.rarity).text">
                                    {{ getRarityLabel(prize.rarity) }}
                                </div>
                            </div>
                        }
                    </div>
                </div>
            }

            <!-- Event Completion Section (Grovs Rewards) -->
            @if ((event.status === 'completed' || event.status === 'ongoing') && event.grovs_reward) {
                <div class="completion-section">
                    <app-event-completion-button
                        [eventId]="event.id"
                        [eventTitle]="event.title"
                        [grovsReward]="event.grovs_reward"
                        [hasCompleted]="event.user_has_completed || false"
                        (completed)="onEventCompleted()">
                    </app-event-completion-button>
                </div>
            }

            <!-- Registration Section -->
            @if (event.requiresRegistration && event.status === 'upcoming') {
                <div class="registration-section">
                    <button class="register-button" (click)="register()" type="button">
                        @if (event.registrationUrl) {
                            <lucide-angular [img]="icons.ExternalLink" [size]="18"></lucide-angular>
                        }
                        <span>Registrarse al evento</span>
                    </button>
                </div>
            }
        </div>
    </div>
</div>
